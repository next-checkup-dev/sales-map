# 주소-좌표 변환 스크립트

구글 시트의 주소 데이터를 위도, 경도로 변환하는 Python 스크립트입니다.

## 기능

- 구글 시트의 D열 주소 데이터를 읽어옵니다
- 카카오 지도 API를 사용하여 주소를 위도, 경도로 변환합니다
- 변환된 좌표를 E열(위도), F열(경도)에 자동으로 입력합니다

## 설치 및 설정

### 1. Python 패키지 설치

```bash
pip install -r requirements.txt
```

### 2. 카카오 REST API 키 발급

1. [카카오 개발자 센터](https://developers.kakao.com/)에 접속
2. 애플리케이션 생성 또는 기존 애플리케이션 선택
3. REST API 키 복사

### 3. 구글 시트 설정

1. 구글 시트에 서비스 계정 이메일을 공유 설정에 추가
2. 스프레드시트 ID 복사 (URL에서 확인 가능)

### 4. 스크립트 설정 수정

`geocoding_script.py` 파일의 다음 부분을 수정하세요:

```python
# 설정값
KAKAO_API_KEY = "YOUR_KAKAO_REST_API_KEY"  # 카카오 REST API 키를 입력하세요
SPREADSHEET_ID = "YOUR_SPREADSHEET_ID"  # 구글 시트 ID를 입력하세요
SHEET_NAME = "Sheet1"  # 시트 이름을 입력하세요
```

## 사용법

### 1. 구글 시트 준비

구글 시트가 다음과 같은 구조여야 합니다:

| A열 | B열 | C열 | D열 | E열 | F열 |
|-----|-----|-----|-----|-----|-----|
| 헤더1 | 헤더2 | 헤더3 | 주소 | 위도 | 경도 |
| 데이터1 | 데이터2 | 데이터3 | 서울시 강남구... | (자동 입력) | (자동 입력) |

### 2. 스크립트 실행

```bash
python geocoding_script.py
```

### 3. 실행 결과

- 각 주소에 대한 변환 진행 상황이 콘솔에 출력됩니다
- 성공적으로 변환된 주소는 위도, 경도가 E, F열에 입력됩니다
- 변환에 실패한 주소는 빈 셀로 남습니다

## 주의사항

1. **API 호출 제한**: 카카오 API는 분당 300회 호출 제한이 있습니다. 스크립트는 0.1초 간격으로 호출하여 제한을 준수합니다.

2. **주소 형식**: 정확한 주소 형식을 사용하세요. 예: "서울시 강남구 테헤란로 123"

3. **인터넷 연결**: 안정적인 인터넷 연결이 필요합니다.

4. **구글 시트 권한**: 서비스 계정이 시트에 대한 편집 권한을 가지고 있어야 합니다.

## 오류 해결

### 카카오 API 오류
- API 키가 올바른지 확인
- 애플리케이션의 JavaScript 키가 아닌 REST API 키를 사용했는지 확인

### 구글 시트 오류
- 서비스 계정 이메일이 시트에 공유되어 있는지 확인
- 스프레드시트 ID가 올바른지 확인
- `google-service-account-key.json` 파일이 올바른 위치에 있는지 확인

### 주소 변환 실패
- 주소가 정확한지 확인
- 너무 구체적이거나 모호한 주소는 변환에 실패할 수 있습니다

## 예시

```
주소-좌표 변환 스크립트 시작
구글 API 인증 성공
총 100행의 데이터를 처리합니다.
처리 중: 2행 - 서울시 강남구 테헤란로 123
  → 위도: 37.5665, 경도: 126.9780
처리 중: 3행 - 부산시 해운대구 해운대로 264
  → 위도: 35.1586, 경도: 129.1603
...
업데이트 완료: 200개 셀
모든 작업이 완료되었습니다! 